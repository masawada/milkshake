var Eggnog={};Eggnog.init=function(b,a,c,d){var e=arguments.callee;if(!(this instanceof e))return new e(b,a,c,d);this.slide=Eggnog.Slide(b);this.utl=Eggnog.Utility(this.slide,a,c,d);this.render=Eggnog.Render(this.slide,this.utl)};Eggnog.init.prototype=function(){return{next:function(){this.render.next()},prev:function(){this.render.prev()},jumpTo:function(b,a){this.render.jumpTo(b,a)},setSize:function(b,a){this.utl.setSize(b,a)},getNote:function(){return this.slide.note}}}();
Eggnog.Slide=function(b){var a=arguments.callee;if(!(this instanceof a))return new a(b);this.slide=b;this.page=this.block=0;this.title=this.slide.title||"Untitled";this.aspect=this.slide.aspect||4/3;this._initialize()};
Eggnog.Slide.prototype=function(){return{_initialize:function(){this._setNote()},next:function(){if(this.block+1<this.slide.pages[this.page].blocks.length)this.block++;else if(this.page+1<this.slide.pages.length)this.block=0,this.page++,this._setNote()},prev:function(){if(this.block>0)this.block--;else if(this.page>0)this.page--,this.block=this.slide.pages[this.page].blocks.length-1,this._setNote()},setPoint:function(b,a){b=parseInt(b);a=parseInt(a);if(0<=b&&b<this.slide.pages.length&&0<=a&&a<this.slide.pages[b].blocks.length)this.page=
b,this.block=a,this._setNote()},getPage:function(){return this.slide.pages[this.page]},getBlock:function(b){b=b===0||parseInt(b)?parseInt(b):this.block;return this.slide.pages[this.page].blocks[b]},_setNote:function(){this.note=this.slide.pages[this.page].note}}}();Eggnog.Render=function(b,a,c){var d=arguments.callee;if(!(this instanceof d))return new d(b,a);this.slide=b;this.utl=a;this._initialize()};
Eggnog.Render.prototype=function(){return{_initialize:function(){var b=$("<div></div>").addClass("en_Slide").css("display","none"),a=this.slide.getBlock(),c=this.slide.getPage();this._showBlock(this._appendBlock(b,a),a);this._showSlide(b,c);this.page=this.slide.page;this.block=this.slide.block},next:function(){this.slide.next();if(this.page!==this.slide.page){var b=$("<div></div>").addClass("en_Slide").css("display","none"),a=this.slide.getBlock(),c=this.slide.getPage();this._showBlock(this._appendBlock(b,
a),a);this._showSlide(b,c);this.page=this.slide.page;this.block=this.slide.block}else if(this.block!==this.slide.block)a=this.slide.getBlock(),this._showBlock(this._appendBlock(this.current,a),a),this.block=this.slide.block},prev:function(){this.slide.prev();if(this.page!==this.slide.page){for(var b=$("<div></div>").addClass("en_Slide").css("display","none"),a=0;a<=this.slide.block;a++){var c=this.slide.getBlock(a);this._showBlock(this._appendBlock(b,c),c)}this._showSlide(b,this.slide.page);this.page=
this.slide.page;this.block=this.slide.block}else if(this.block!==this.slide.block)$(".en_Block:last-child").remove(),this.block=this.slide.block},jumpTo:function(b,a){this.slide.setPoint(b,a);if(this.page!==this.slide.page||this.block!==this.slide.block){for(var c=$("<div></div>").addClass("en_Slide").css("display","none"),d=0;d<=this.slide.block;d++)a=this.slide.getBlock(d),this._showBlock(this._appendBlock(c,a),a);this._showSlide(c,this.slide.page);this.page=this.slide.page;this.block=this.slide.block}},
_appendBlock:function(b,a){for(var c=$("<div></div>").addClass("en_Block").css("display","none"),d=a.elements,e=0;e<d.length;e++)this._appendElement(c,d[e]);b.append(c);return c},_appendElement:function(b,a){a.type==="title"?b.append($("<h1></h1>").addClass("en_Title").text(a.value).css(a.style)):a.type==="text"?b.append($("<p></p>").addClass("en_Text").text(a.value).css(a.style)):a.type==="link"?b.append($("<p></p>").addClass("en_Link").css(a.style).append($("<a></a>").attr("href",a.href).text(a.value))):
a.type==="image"?b.append($("<img>").addClass("en_Image").css(a.style).attr("src",a.src)):a.type==="tag"&&b.append($("<div></div>").addClass("en_tag").append($(a.tag)))},_showBlock:function(b,a){b.css("display","block");typeof a.script==="function"&&a.script()},_showSlide:function(b,a){$(this.utl.base).append(b);b.css("display","block");this.current&&this.current.remove();typeof a.script==="function"&&a.script();this.current=b}}}();
Eggnog.Utility=function(b,a,c,d){var e=arguments.callee;if(!(this instanceof e))return new e(b,a,c,d);this.slide=b;this.base=typeof a==="string"?document.getElementById(a):a;this.aspect=this.slide.aspect;this.width=this.height=this.fontSize=0;this._initialize(c,d)};
Eggnog.Utility.prototype=function(b){return{_initialize:function(a,b){this.setSize(a,b);this.setTitle(this.slide.title)},setSize:function(a,c){a=a==="window"?b(window).width():a;c=c==="window"?b(window).height():c;this._calcSize(Number(a),Number(c));b(this.base).css({width:this.width+"px",height:this.height+"px"});b(document.body).css("fontSize",this.fontSize+"px")},setTitle:function(a){document.title=a||"Untitled"},_calcSize:function(a,b){b*this.aspect<a?a=b*this.aspect:b=a/this.aspect;var d;this.width=
a;this.height=b;this.fontSize=b/10}}}(jQuery);
